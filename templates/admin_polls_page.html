<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Create a Poll</title>

    <link rel="stylesheet" href="./static/style.css">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css'>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css'>
    
    <style>
        .divider-vertical {
            border-left: 1px solid #ccc;
            height: 100%;
        }
    </style>
</head>

<body>
    {% include 'admin_navbar.html' %}
    <div class="mask d-flex align-items-center h-100 gradient-custom-3">
        <div class="container mt-5 mb-5">
            <div class="row justify-content-center">
                <div class="col-md-7"> <!-- Center the column -->
                    <div class="card mt-3 mb-3" style="border-radius: 15px;">
                        <div class="card-body p-5">
                            <h2 class="text-uppercase text-center mb-5">Create a Poll</h2>

                            {% for mesg in get_flashed_messages() %}
                                <div class="alert alert-danger">
                                    <strong>{{ mesg }}</strong>
                                </div>
                            {% endfor %}

                            <form action="{{ url_for('admin_polls') }}" method="post">
                                <div data-mdb-input-init class="form-outline mb-2">
                                    <label class="form-label" for="VendorName">Vendor Name</label>
                                    <select class="form-select form-select-sm mb-2" aria-label=".form-select-sm" name="VendorName" id="VendorName" required>
                                        <option value="" disabled selected>Please select a Vendor</option>
                                        {% for vendor in vendors %}
                                            <option value="{{ vendor.id }}">{{ vendor.get('Vendor_Name') }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div data-mdb-input-init class="form-outline mb-2">
                                    <label class="form-label" for="PollTitle">Poll Title</label>
                                    <input type="text" id="PollTitle" name="PollTitle" class="form-control form-control-md" maxlength="100" required> 
                                </div>

                                <div data-mdb-input-init class="form-outline mb-2">
                                    <label class="form-label" for="Amount">Amount of Choices</label>
                                    <select class="form-select form-select-sm mb-2" aria-label=".form-select-sm" name="Amount" id="Amount" required>
                                        <option value="" disabled selected>Please select how many choices you would like</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                    </select>
                                </div>

                                <div id="pollChoices"></div> <!-- Container for dynamically generated input fields -->

                                <div class="d-flex justify-content-center">
                                    <button type="submit" data-mdb-button-init data-mdb-ripple-init class="btn btn-success btn-block btn-lg gradient-custom-4 text-body">Submit</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-5"> <!-- Center the column -->
                    <div class="card mb-3" style="border-radius: 15px; margin-left: 50px">
                        <div class="card-body p-3">
                            <h2 class="text-uppercase text-center mb-4">Polls</h2>

                            {% for poll in polls %}
                                <div style="border-radius: 15px;" class="card mb-3">
                                    <div class="card-body">
                                        <p><strong>Poll #{{ loop.index }}:</strong></p>
                                        <p><strong>Vendor Name:</strong> {{ poll.get('Vendor_Name') }}</p>
                                        <p><strong>Poll Title:</strong> {{ poll.get('Title') }}</p>
                                        <ul class="list-group">
                                            {% for option in poll.get('options') %}
                                                <li class="list-group-item"><strong>Option #{{ loop.index }}:</strong> {{ option }}</li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const selectElement = document.getElementById('Amount');
            const inputContainer = document.getElementById('pollChoices');
          
            selectElement.addEventListener('change', function() {
                // Clear existing input fields
                inputContainer.innerHTML = '';
            
                // Get the selected number of choices
                const numberOfChoices = parseInt(this.value);
            
                // Generate new input fields based on the selected number
                for (let i = 0; i < numberOfChoices; i++) {
                    // Create a new input element
                    const inputField = document.createElement('input');
                    inputField.type = 'text';
                    inputField.className = 'form-control mb-2';
                    inputField.name = `choice${i + 1}`;
                    inputField.placeholder = `Choice ${i + 1}`;
            
                    // Append the new input field to the container
                    inputContainer.appendChild(inputField);
                }
            });
        });
    </script>

</body>
</html>
